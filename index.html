<!DOCTYPE HTML>
<html>
    <head>
        <title>DrumPads</title>
               <script src="Tone.js" type="text/javascript">
        </script>
        
        <script src="nexusUI.js" type="text/javascript">
            </script>
        
        <style>
            body, html {
                
                width: 100%;
                height: 100%;
                background-color: rgb(100,200,200);
                margin: 0;
                padding: 0;

            }
        
        div#padArea {
            width: 100%;
            height: 80%;
            background-color: #b0e0e6;
            overflow: hidden;
            padding:0px;
            
        }
        
        div#controlBar {
            border: 2px solid black;
            
            width: 50%;
            height: 20%;
            background-color: grey;
            overflow: hidden;
        }
        
        canvas[nx="button"] {
            width: 30%;
            height: 30%;
        }
        </style>
    </head>
    <body id="mainBody">
        
        
        
        <div id ="padArea">
            
            <canvas nx="button"></canvas>
            <canvas nx="button"></canvas>
            <canvas nx="button"></canvas>
            <br>
            <canvas nx="button"></canvas>
            <canvas nx="button"></canvas>
            <canvas nx="button"></canvas>
            <br>
            <canvas nx="button"></canvas>
            <canvas nx="button"></canvas>
            <canvas nx="button"></canvas>
        </div>
    
        <div id="controlBar">
           <canvas nx="tabs"></canvas>
       </div>

    </body>
    <script>
        
              //set up player
        var player = [];
        var buttons = [];
        
        //fill array with elements.
        for(var i=1; i<=9; i++) {
            buttons[i] = document.getElementById("button"+i);
        }
    /*
       for(var i=1; i<=9; i++){
            player[i] = new Tone.Player("samples/Kit" + i + "/" + i + ".wav").toMaster();
       }
      */
    
        //Temporary Player Setup code
        player[1] = new Tone.Player("samples/Kit1/1.wav").toMaster();
        player[2] = new Tone.Player("samples/Kit1/2.wav").toMaster();
        player[3] = new Tone.Player("samples/kit1/3.wav").toMaster();
        player[4] = new Tone.Player("samples/kit1/4.wav").toMaster();
        player[5] = new Tone.Player("samples/kit1/5.wav").toMaster();
        player[6] = new Tone.Player("samples/kit1/6.wav").toMaster();
        player[7] = new Tone.Player("samples/kit1/7.wav").toMaster();
        player[8] = new Tone.Player("samples/kit1/8.wav").toMaster();
        player[9] = new Tone.Player("samples/kit1/9.wav").toMaster();
        
        


           nx.onload = function() {
               
               for(var i=1; i<=9; i++) {
                   buttons[i] = document.getElementById("button"+i);
               }
                    /*
<!--               for(var i=1; i<=9; i++) {-->
<!--                   buttons[i].on('*', xyActions);-->
<!--                   buttons[i].on('*', pressActions);-->
<!--               }-->
*/
            //set up Event listeners
            button1.on('*', xyActions);
            button1.on('*', function(btn){ playSoundFor(btn, 1); });
            button1.mode = "aftertouch";
            
            button2.on('*', xyActions);
            button2.on('*', function(btn){ playSoundFor(btn, 2); });
            button2.mode = "aftertouch";
            
            button3.on('*', xyActions);
            button3.on('*', function(btn){ playSoundFor(btn, 3); });
            button3.mode = "aftertouch";
            
            button4.on('*', xyActions);
            button4.on('*', function(btn){ playSoundFor(btn, 4); });
            button4.mode = "aftertouch";
            
            button5.on('*', xyActions);
            button5.on('*', function(btn){ playSoundFor(btn, 5); });
            button5.mode = "aftertouch";
            
            button6.on('*', xyActions);
            button6.on('*', function(btn){ playSoundFor(btn, 6); });
            button6.mode = "aftertouch";
            
            button7.on('*', xyActions);
            button7.on('*', function(btn){ playSoundFor(btn, 7); });
            button7.mode = "aftertouch";
            
            button8.on('*', xyActions);
            button8.on('*', function(btn){ playSoundFor(btn, 8); });
            button8.mode = "aftertouch";
            
            button9.on('*', xyActions);
            button9.on('*', function(btn){ playSoundFor(btn, 9); });
            button9.mode = "aftertouch";






            
            
           }
    

var playSoundFor = function(btn, playerNumber) {
    
         if (btn.press == 1)
         {
            console.log(playerNumber);
            player[playerNumber].start();
         }
    }
    /*
<!--    var pressActions = function(event) {-->
<!--        -->
<!--        if (event.press == 1)-->
<!--        {-->
<!--            console.log("boop");-->
<!--            player[1].start();-->
<!--            -->
<!--        -->
<!--        }-->
<!--    }-->
    
    */
    var xyActions = function(event) {
        console.log( event.x + " " + event.y );
        
        //if ( event.y > 0.2 ) {
        //  console.log("over");
        //}
        //else
        //{
        //  console.log("under");
        //}
    }
    
<!--    function padActions(event){-->
<!--        var x = event.target.tagName;-->
<!--        consle.log(x);-->
<!--        var padThatWasClicked = event.target;-->
<!--        var padIndexInArray = buttons.indexOf(padThatWasClicked);-->
<!--        -->
<!--       -->
<!--        player[padIndexInArray].start();-->
<!--    }-->


        </script>
      <script>
    // ios web audio context is muted by default
    // workaround is to make a touchstart trigger an audio source
    window.addEventListener('touchstart',
      function() { 
        // create empty buffer
        var buffer = Tone.context.createBuffer(1, 1, 22050);
        var source = Tone.context.createBufferSource();
        source.buffer = buffer; 
      
      // connect to output (your speakers) 
      source.connect(Tone.context.destination); 
      
      // play the file
      source.start();
      source.noteOn(0); 
    }, false);
  </script>
  
    
</html>
